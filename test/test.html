<!DOCTYPE html>
<!-- saved from url=(0026)http://myway5.com/?post=58 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>c++中的中文字符分割 - 一只安静的猫</title>
        
        <meta name="keywords" content="php   c++,c++">
        <meta name="description" content="在utf-8编码的前提下，一个字符可能占用的空间为1~4个char，由于这种不确定的字符长度导致在utf-8编码的string中，无法直接使用substr进行字符串分割...">
        <meta name="generator" content="emlog">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1">
        <meta http-equiv="X-UA-Compatible" content="IE=9">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0,user-scalable=no">
        <link href="./c++中的中文字符分割 - 一只安静的猫_files/bootstrap.min.css" rel="stylesheet">
        <link type="text/css" href="./c++中的中文字符分割 - 一只安静的猫_files/main.css" rel="stylesheet">
	    <link type="text/css" href="./c++中的中文字符分割 - 一只安静的猫_files/markdown.css" rel="stylesheet">
        
       <!-- <script type="text/javascript" src="http://myway5.com/content/templates/emlog_theme/js/blogtags.js"></script>  -->      
        <!--[if lt IE 9]>
        <script src="http://cdn.gbtags.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="http://cdn.gbtags.com/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
        <script src="./c++中的中文字符分割 - 一只安静的猫_files/jquery.min.js" type="text/javascript"></script>
        <script src="./c++中的中文字符分割 - 一只安静的猫_files/bootstrap.min.js"></script>
        <script type="text/javascript" src="./c++中的中文字符分割 - 一只安静的猫_files/layer.js"></script><link rel="stylesheet" href="./c++中的中文字符分割 - 一只安静的猫_files/layer.css" id="layui_layer_skinlayercss">
        <script type="text/javascript" src="./c++中的中文字符分割 - 一只安静的猫_files/function.js"></script> 
       <link href="./c++中的中文字符分割 - 一只安静的猫_files/github.css" rel="stylesheet">    </head>
    <body>
		<nav class="navbar nav-default navbar-fixed-top navColor">
          <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <img src="./c++中的中文字符分割 - 一只安静的猫_files/button.png" width="30" height="30">
              </button>
              <a class="navbar-brand" href="http://myway5.com/">一只安静的猫</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">
	        		  <li><a href="http://myway5.com/">首页</a></li>
        	    		<li class="dropdown">
            <a href="http://myway5.com/?sort=10" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">java 学习<span class="caret"></span></a>
            <ul class="dropdown-menu">
                
                <li><a href="http://myway5.com/?sort=12">jvm</a></li><li><a href="http://myway5.com/?sort=13">JavaEE</a></li><li><a href="http://myway5.com/?sort=14">javaSE</a></li>            </ul>
        </li>
        	        		  <li><a href="http://myway5.com/?sort=1">日常点滴</a></li>
        	        		  <li><a href="http://myway5.com/?sort=9">安卓开发</a></li>
        	        		  <li><a href="http://myway5.com/?sort=4">php+前台学习</a></li>
        	        		  <li><a href="http://myway5.com/?sort=7">emlog相关</a></li>
        	        		  <li><a href="http://myway5.com/?post=3">留言</a></li>
        		</ul>
              <form class="navbar-form navbar-right search_input" name="keyform" role="search" method="get" action="http://myway5.com/index.php">
                <div class="form-group">
                  <input type="text" class="form-control" name="keyword" placeholder="Search">
                </div>
                <input type="submit" class="btn btn-default" value="搜索">
              </form>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
		<div class="clearfix"></div>
        <div class="container-fluid main">
<article class="article">
    <h1>c++中的中文字符分割</h1>
    <div class="content"><p>
	<span style="font-size:16px;">在utf-8编码的前提下，一个字符可能占用的空间为1~4个char，由于这种不确定的字符长度导致在utf-8编码的string中，无法直接使用substr进行字符串分割。</span> 
</p>
<p>
	<br>
</p>
<p>
	<span style="font-size:16px;">解决的方案的关键在于利用utf-8编码的特点，utf-8的第一个字符的前缀连续为1的个数代表这个”字“占用的字符数量，当只有一个字符时，第一个字符的第一位为0。具体的说明可以参考这篇文章。http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html</span> 
</p>
<p>
	<span style="font-size:16px;"><br>
</span> 
</p>
<p>
	<span style="font-size:16px;">这里主要说明怎么利用代码解决这个问题</span> 
</p>
<p>
	<span style="font-size:16px;"><br>
</span> 
</p>
<p>
	<span style="font-size:16px;"> </span> 
</p>
<pre class="brush:cpp; toolbar: true; auto-links: true;">int getUtf8CharLength(char c){
&nbsp; &nbsp; int len = 0;
&nbsp; &nbsp; if(c &gt; 0){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//利用计算机中数字的存储特点，第一位为1为负，第一位为0为正，很容易判断
&nbsp; &nbsp; &nbsp; &nbsp; return len + 1; &nbsp; &nbsp; //第一位为0时为特殊情况，需要加1
&nbsp; &nbsp; }
&nbsp; &nbsp; while(c &lt; 0){
&nbsp; &nbsp; &nbsp; &nbsp; len++;
&nbsp; &nbsp; &nbsp; &nbsp; c = c &lt;&lt; 1;
&nbsp; &nbsp; }
&nbsp; &nbsp; return len;
}

std::string substrWithChinese(std::string str,unsigned int start,unsigned int length){
    unsigned int i = 0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //标识前进的几个“字符”
    unsigned int cursor = 0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//标识前进了几个“字”
    unsigned int save = 0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//保存的字符标识
    unsigned int len = str.length();
    char* c = new char[len + 1];
    while(str[i] != '\0'&amp;&amp;length &gt; 0){
        unsigned int l = getUtf8CharLength(str[i]); //获取字符长度
        if(cursor &gt;= start){
            unsigned int m = l;
            while(m--){
                c[save++] = str[i++];
            }
            length--;
        }else{
            i+=l;
        }
        cursor++;
    }</pre>
<pre class="brush:cpp; toolbar: true; auto-links: true;">&nbsp;&nbsp;&nbsp;&nbsp;c[i] = '\0';
    return std::string(c);
}</pre>
<br>
<p>
	<br>
</p></div>
</article>
<div class="property">
        </div>
<div class="neighbor_log">
                <div class="left_log">上一篇:这是最新的文章</div>
                    <div class="right_log">下一篇:<a href="http://myway5.com/?post=56" title="下一篇linux下编译安装mysql-connector-cpp">linux下编译安装mysql-conn...</a></div>
            <div class="clearfix"></div>
</div>
<div class="panel panel-default comments">
    <ul class="list-group commentslist">
        <li class="list-group-item">
                    <form method="post" name="commentform" action="http://myway5.com/index.php?action=addcom" id="commentform">
            <div class="comment_input">
            <input type="hidden" name="gid" value="58">
                                            <div class="input-group">
                    <span class="input-group-addon" id="basic-addon1">评论</span>
                    <textarea name="comment" id="comment_textarea" class="form-control" tabindex="4" placeholder=""></textarea>
                </div>
                                <input name="submit" type="submit" class="btn btn-default right" tabindex="5" value="评论">
                <input type="hidden" name="pid" id="comment_pid" value="0" size="22" tabindex="1">
                <div class="clearfix"></div>    
            </div>
        </form>
        </li>
                                                    <div class="navigation"><div class="pagination">  </div></div>
    </ul>    
</div>
        <div class="clearfix"></div>
    <div class="footer">
        Copyright ©  2015 <a href="http://myway5.com/">一只安静的猫</a>. Powered by <a href="http://www.emlog.net/" rel="external">emlog</a>.
        Theme by <a href="http://myway5.com/" rel="external">what</a>.
        <a href="http://www.miibeian.gov.cn/" target="_blank" rel="nofollow">皖ICP备15026565号-1</a>
          
        <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1254807243'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s11.cnzz.com/z_stat.php%3Fid%3D1254807243%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script><span id="cnzz_stat_icon_1254807243"></span><script src="http://s11.cnzz.com/z_stat.php?id=1254807243&amp;show=pic" type="text/javascript"></script>    </div>
</div>


</body></html>